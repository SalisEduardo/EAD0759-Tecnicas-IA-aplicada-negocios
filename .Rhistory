#   labs(title = "Distribuicao das vendas")
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
# carseats |>
#   ggplot(aes(x=Sales)) +
#   geom_histogram(bins = 50) +
#   labs(title = "Distribuicao das vendas")
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales)) +
geom_boxplot(color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
# carseats |>
#   ggplot(aes(x=Sales)) +
#   geom_histogram(bins = 50) +
#   labs(title = "Distribuicao das vendas")
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales)) +
geom_boxplot(color="#e9ecef",alpha = 0.5, fill = "darkgreen") +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales)) +
geom_boxplot(color="#e9ecef",alpha = 0.5, fill = "darkgreen") +
theme_classic()
box(carseats$Sales)
plot(carseats$Sales,type = "box")
carseats |>
ggplot() +
geom_boxplot(aes(y="Sales"))
carseats |>
ggplot(aes(x=factor(0),Sales)) +
geom_boxplot()
carseats |>
ggplot(aes(x=ShelveLoc,Sales)) +
geom_boxplot()
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
layout(mat = matrix(c(1,2),2,1, byrow=TRUE),  height = c(1,8))
# Draw the boxplot and the histogram
par(mar=c(0, 3.1, 1.1, 2.1))
boxplot(carseats$Sales , horizontal=TRUE , ylim=c(-10,20), xaxt="n" , col=rgb(0.8,0.8,0,0.5) , frame=F)
par(mar=c(4, 3.1, 1.1, 2.1))
hist(carseats$Sales , breaks=40 , col=rgb(0.2,0.8,0.5,0.5) , border=F , main="" , xlab="Sales", xlim=c(-10,20))
layout(mat = matrix(c(1,2),2,1, byrow=TRUE),  height = c(1,8))
# Draw the boxplot and the histogram
par(mar=c(0, 3.1, 1.1, 2.1))
boxplot(carseats$Sales , horizontal=TRUE , ylim=c(-10,20), xaxt="n" , col=rgb(0.8,0.8,0,0.5) , frame=F)
par(mar=c(4, 3.1, 1.1, 2.1))
hist(carseats$Sales , breaks=40 , col=rgb(0.2,0.8,0.5,0.5) , border=F , main="" , xlab="Sales")
carseats <- carseats |>
dplyr::mutate(High = as.factor(ifelse(Sales <= ALVO,"No","Yes")))
carseats |>
ggplot(aes(x = Sales,fill=US)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=US)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, position = 'dodge') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=US)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5) +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=US)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=ShelveLoc)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=ShelveLoc)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'dodge') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=Urban)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=Urban)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'dodge') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=US)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'dodge') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales,fill=ShelveLoc)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5,position = 'dodge') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x=ShelveLoc,Sales)) +
geom_boxplot()
carseats |>
ggplot(aes(x=ShelveLoc,Sales)) +
geom_boxplot(fill=ShelveLoc)
carseats |>
ggplot(aes(x=ShelveLoc,y=Sales,fill=ShelveLoc)) +
geom_boxplot()
carseats |>
ggplot(aes(x=ShelveLoc,y=Sales,fill=US)) +
geom_boxplot()
carseats |>
ggplot(aes(x=ShelveLoc,y=Sales,fill=US)) +
geom_boxplot()
carseats |>
ggplot(aes(x=US,y=Sales,fill=US)) +
geom_boxplot()
carseats |>
ggplot(aes(x=Urban,y=Sales,fill=Urban)) +
geom_boxplot()
carseats |>
ggplot(aes(x=Urban,y=Sales,fill=Urban)) +
geom_boxplot() +
geom_jitter(color="black", size=0.4, alpha=0.9) +
carseats |>
ggplot(aes(x=Urban,y=Sales,fill=Urban)) +
geom_boxplot() +
geom_jitter(color="black", size=0.4, alpha=0.9)
carseats |>
ggplot(aes(x=US,y=Sales,fill=US)) +
geom_boxplot() +
geom_jitter(color="black", size=0.4, alpha=0.9)
for(col in c("US","ShelveLoc","Urban")){
ggplot(data = carseats,aes(y="High",fill=col))+
geom_bar()
}
for(col in c("US","ShelveLoc","Urban")){
print.AsIs(ggplot(data = carseats,aes(y="High",fill=col))+
geom_bar())
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y="High",fill=col))+
geom_bar())
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y="High",x=col,fill=col))+
geom_bar())
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y="High",x=col,fill=col))+
geom_col())
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y="High",x=col,fill=col))+
geom_col(stat = "identity"))
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y="High",x=col,fill=col))+
geom_bar(stat = "identity"))
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y=High,x=col,fill=col))+
geom_bar(stat = "identity"))
}
for(col in c("US","ShelveLoc","Urban")){
print(ggplot(data = carseats,aes(y=High,x=`col`,fill=col))+
geom_bar(stat = "identity"))
}
carseats |>
ggplot(aes(High)) + geom_bar(aes(fill = ShelveLoc))
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = ShelveLoc))
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = High))
carseats |>
ggplot(aes(High)) + geom_bar(aes(fill = ShelveLoc),position = 'dodge')
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = High),position = 'dodge')
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = {"High"}),position = 'dodge')
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = {{"High"}}),position = 'dodge')
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = !!sym("High")),position = 'dodge')
for(col in c("ShelveLoc","US","Urban")){
carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = !!sym(col)),position = 'dodge')
}
for(col in c("ShelveLoc","US","Urban")){
print(carseats |>
ggplot(aes(ShelveLoc)) + geom_bar(aes(fill = !!sym(col)),position = 'dodge'))
}
#| output: false
library(tidyverse)
library(dplyr)
library(ggplot2)
library(hrbrthemes)
library(ISLR)
library(tree)
carseats <- ISLR::Carseats
ALVO <- 8 #definir se sera uma venda alta ou baixa
carseats |> head()
carseats |> str() # tipos dos dados
carseats |> dim() # tamanho da tabela
carseats |> is.na()  |> sum()
carseats |> summary()
#| output: false
library(tidyverse)
library(dplyr)
library(ggplot2)
library(hrbrthemes)
library(ISLR)
library(tree)
carseats <- ISLR::Carseats
ALVO <- 8 #definir se sera uma venda alta ou baixa
carseats |> head()
carseats |> str() # tipos dos dados
carseats |> dim() # tamanho da tabela
carseats |> is.na()  |> sum()
carseats |> summary()
carseats <- carseats |>
dplyr::mutate(High = as.factor(ifelse(Sales <= ALVO,"No","Yes")))
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
Â´
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
carseats |>
ggplot(aes(x = Sales)) +
geom_histogram(binwidth = 1,color="#e9ecef",alpha = 0.5, fill = "darkgreen", position = 'identity') +
labs(x = "Sales", y = "Count", title = "Distribution of Sales") +
theme_classic()
for(col in c("ShelveLoc","US","Urban")){
print(carseats |>
ggplot(aes(!!sym(col))) + geom_bar(aes(fill = High),position = 'dodge'))
}
library(ggExtra)
install.packages("ggExtra")
names(carseats)
names(carseats[-c("ShelveLoc","US","Urban","High")])
names(carseats[,-c("ShelveLoc","US","Urban","High")])
carseats[,-c("ShelveLoc","US","Urban","High")]
subset(carseats, select = -c("ShelveLoc","US","Urban","High"))
names(carseats[,-c(ShelveLoc,US,Urban,High)])
names(carseats[,-c(ShelveLoc,US,Urban,)])
names(carseats[,-c(ShelveLoc,US,Urban)])
subset(carseats, select = -c(ShelveLoc,US,Urban,High))
names(subset(carseats, select = -c(ShelveLoc,US,Urban,High)))
library(ggExtra)
for(col in names(subset(carseats, select = -c(ShelveLoc,US,Urban,High)))){
p <- ggplot(carseats, aes(x=High, y=!!sym(col), color=cyl, size=cyl)) +
geom_point() +
theme(legend.position="none")
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=10)
}
for(col in names(subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales)))){
p <- ggplot(carseats, aes(x=Sales, y=!!sym(col))) +
geom_point() +
theme(legend.position="none")
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=10)
}
for(col in names(subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales)))){
p <- ggplot(carseats, aes(x=Sales, y=!!sym(col))) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10)
print(p1)
}
for(col in names(subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales)))){
p <- ggplot(carseats, aes(y=Sales, x=!!sym(col))) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10)
print(p1)
}
for(col in names(subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales)))){
p <- ggplot(carseats, aes(y=Sales, x=!!sym(col))) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10,fill = "slateblue", xparams = list(  bins=10))
print(p1)
}
for(col in names(subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales)))){
p <- ggplot(carseats, aes(y=Sales, x=!!sym(col))) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10,fill = "slateblue")
print(p1)
}
help("Carseats")
p <- ggplot(carseats, aes(y=Sales, x=CompPrice,color=Price,size=Price)) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10,fill = "slateblue")
print(p1)
library(RColorBrewer) # for the color palette
library(hrbrthemes)
library(GGally)
install.packages("GGally")
carseats_numeric <-subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales))
ggpairs(carseats_numeric, title="correlogram with ggpairs()")
library(GGally)
carseats_numeric <-subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales))
ggpairs(carseats_numeric, title="correlogram with ggpairs()")
help(ggpairs)
carseats_numeric <-subset(carseats, select = -c(ShelveLoc,US,Urban,High,Sales))
ggpairs(carseats_numeric, title="Correlograma")
carseats_numeric <-subset(carseats, select = -c(ShelveLoc,US,Urban,High))
ggpairs(carseats_numeric, title="Correlograma")
ggcorr(carseats_numeric, method = c("everything", "pearson"))
p <- ggplot(carseats, aes(y=Price, x=CompPrice)) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10,fill = "slateblue")
print(p1)
?ggcorr
ggcorr(carseats_numeric, method = c("everything", "pearson"),label = TRUE)
p <- ggplot(carseats, aes(y=Price, x=CompPrice)) +
geom_point() +
theme(legend.position="none")
p1 <- ggMarginal(p, type="histogram", size=10,fill = "slateblue")
print(p1)
names(carseats)
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), columns = 2:4, ggplot2::aes(colour=High))
names(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High),upper = list(continuous = wrap("cor", size = 9)))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High),upper = list(continuous = wrap("cor", size = 3)))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)),alpha=0.5, ggplot2::aes(colour=High),upper = list(continuous = wrap("cor", size = 3)))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High,alpha=0.5),upper = list(continuous = wrap("cor", size = 3)))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High,alpha=0.5),upper = list(continuous = "cor"))
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High,alpha=0.5),upper = list(continuous = "cor"), lower = "blank")
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High,alpha=0.5),upper = list(continuous = "cor",size=2), lower = "blank")
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High,alpha=0.5),upper = list(continuous = "cor",size=1), lower = "blank")
ggpairs(subset(carseats, select = -c(ShelveLoc,US,Urban,Sales)), ggplot2::aes(colour=High,alpha=0.5),upper = list(continuous = wrap("cor", size = 3)), lower = "blank")
library(caret)
install.packages("caret")
library(caret)
help("createDataPartition")
# Split the data into 75% training and 25% testing sets
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- iris[carseats_trainIndex, ]
test_carseats <- iris[-carseats_trainIndex, ]
test_carseats
# Split the data into 75% training and 25% testing sets
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex, ]
test_carseats <- carseats[-carseats_trainIndex, ]
test_carseats
# Repartindo entre treino e teste
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex,-Sales ]
test_carseats <- carseats[-carseats_trainIndex,-Sales ]
tree_carseats_train = tree(High~, training_carseats)
tree_carseats_train = tree(High~., training_carseats)
tree_carseats_train = tree(High ~ ., training_carseats)
tree_carseats_train = tree(High ~ ., data= training_carseats)
tree_carseats_train = tree(High~., data= training_carseats)
help("tree")
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex,-Sales ]
test_carseats <- carseats[-carseats_trainIndex,-Sales ]
training_carseats
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex, ]
test_carseats <- carseats[-carseats_trainIndex, ]
training_carseats
carseats[carseats_trainIndex, ][-Sales]
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex, ][,-Sales]
test_carseats <- carseats[-carseats_trainIndex, ]
training_carseats
carseats[carseats_trainIndex, ] |>
dplyr::select(-Sales)
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex, ] |>
dplyr::select(-Sales)
test_carseats <- carseats[-carseats_trainIndex, ]|>
dplyr::select(-Sales)
dim(test_carseats)
dim(training_carseats)
carseats_trainIndex <- createDataPartition(carseats$High, p = 0.75, list = FALSE)
training_carseats <- carseats[carseats_trainIndex, ] |>
dplyr::select(-Sales)
test_carseats <- carseats[-carseats_trainIndex, ]|>
dplyr::select(-Sales)
print("Train dimentions: ")
dim(training_carseats)
print("Test dimentions: ")
dim(test_carseats)
head(training_carseats)
head(test_carseats)
tree(High ~ ., data= training_carseats)
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0)
tree_carseats_train = tree(High ~ ., data= training_carseats)
#plot(tree_carseats_train )
text(tree_carseats_train , pretty=0)
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=1.5)
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=0.5)
options(repr.plot.width=10, repr.plot.height=8)  # set plot size
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=0.5)
options(repr.plot.width=10, repr.plot.height=8)  # set plot size
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=0.65)
options(repr.plot.width=10, repr.plot.height=8)  # set plot size
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=0.5)
set.seed(42)
options(repr.plot.width=10, repr.plot.height=8)  # set plot size
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=0.5)
set.seed(42)
options(repr.plot.width=10, repr.plot.height=8)  # set plot size
tree_carseats_train = tree(High ~ ., data= training_carseats)
plot(tree_carseats_train )
text(tree_carseats_train , pretty=0,cex=0.55)
summarise(carseats$Price)
summarise(carseats)
summarise(carseats)
summarise(Carseats)
summary(carseats)
carseats |>
ggplot( aes(x=Age, y=Sales)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
theme_ipsum()
carseats |>
ggplot( aes(x=Age, y=Sales)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE) +
theme_classic()
importance(tree_carseats_train)
caret::varImp(tree_carseats_train)
install.packages("randomForest")
varImp(tree_carseats_train)
prdict_test <- predict(tree_carseats_train,test_carseats,type='class')
rm(prdict_test)
predict_test <- predict(tree_carseats_train,test_carseats,type='class')
predict_test
predict_test <- predict(tree_carseats_train,test_carseats,type='class')
conf_matrix <- caret::confusionMatrix(data = predict_test,reference = test_carseats$High)
conf_matrix
test_carseats |> count(High)
# checando o balanceamento dos dados
test_carseats |>
count(High) |>
mutate(prop= n/ sum(n))
predict_train =  predict(tree_carseats_train, training_carseats, type = "class")
conf_matrix_train <- confusionMatrix(data = predict_train, reference = training_carseats$High)
conf_matrix_train
cv.carseats = cv.tree(train_carseats, FUN = prune.misclass)
cv.carseats = cv.tree(tree_carseats_train, FUN = prune.misclass)
cv.carseats
plot(cv.carseats)
prune.carseats = prune.misclass(cv.carseats, best = 12)
prune.carseats = prune.misclass(tree_carseats_train, best = 12)
plot(prune.carseats)
text(prune.carseats, pretty=0)
prune_tree_pred = predict(prune.carseats, test_carseats, type="class")
prune_conf_matrix <- caret::confusionMatrix(data = prune_tree_pred,reference = test_carseats$High)
prune_conf_matrix
conf_matrix
47/59
test_carseats |>
count(High)
29/41
49/59
10/26
26/41
